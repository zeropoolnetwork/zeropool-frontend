const { addBeforeLoader, loaderByName } = require('@craco/craco');
const { ProvidePlugin } = require('webpack');

module.exports = {
  ignoreWarnings: [
    {
      message: /source-map-loader/, // not works
    },
  ],
  devServer: {
    client: {
      overlay: false,
      logging: 'error',
    },
  },
  stats: {
    modules: false,
    assets: false,
  },
  webpack: {
    configure: {
      resolve: {
        fallback: {
          'http': require.resolve('stream-http'),
          'https': require.resolve('https-browserify'),
          'crypto': require.resolve('crypto-browserify'),
          'os': require.resolve('os-browserify/browser'),
          'path': require.resolve('path-browserify'),
          'assert': require.resolve('assert'),
          'fs': false,
        },
        alias: {
          process: 'process/browser.js',
          stream: 'stream-browserify',
        }
      },
      module: {
        rules: [{
          test: /\.wasm$/,
          type: 'webassembly/async',
        },]
      },
      experiments: {
        asyncWebAssembly: true,
      },

    },
    plugins: {
      add: [
        new ProvidePlugin({
          Buffer: ['buffer', 'Buffer'],
          process: 'process'
        })
      ]
    }
  }
};
